<sly data-sly-use.profile="com.mcd.rwd.us.core.sso_profile.Profile"/>
<!-- Profile -->
<div tabindex="0" class="main sso-full-height ssoMainContent" role="main" data-json="${profile.json}" ng-controller="ProfileController" ng-switch="view.view" ng-cloak>
    <div class="sso-preloader" ng-show="preloader"></div>
    <div ng-switch-when="profileMenu">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                    <h1 class="sso-h1" data-sly-test="${profile.profileSectionTitle}">${profile.profileSectionTitle}</h1>
                </div>
            </div>
        </div>
        <div class="container-fluid sso-full-width">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
                    <ul class="sso-list">
                        <li>
                            <a href="javascript: void(0);" ng-click="nextStep('profileDetails')" title="${profile.linkTitlePersonalDetails}"> <span class="sso-badge"><i class="fa fa-chevron-right"></i></span>${profile.linkTitlePersonalDetails} </a>
                        </li>
                        <!--/*<li data-sly-test=${profile.deleteAccountEnabled}>*/-->
                        <li>
                            <a href="javascript: void(0);" ng-click="nextStep('settings')" title="${profile.linkTitleSettings}">
                                <span class="sso-badge"><i class="fa fa-chevron-right"></i></span>
                                <!--/* the badge below should only be shown when the user needs to verify their account */-->
                                <span ng-if="emailUpdatedNeedsVerification" class="sso-badge-notice"><i class="fa fa-exclamation-circle fa-lg"></i></span>
                                ${profile.linkTitleSettings}
                            </a>
                        </li>
                        <!--/*
                        <li data-sly-test=${!profile.deleteAccountEnabled}>
                            <a href="javascript: void(0);" ng-click="nextStep('updatepassword')"  title="${profile.updatePasswordLinkTitle}"> <span class="sso-badge"><i class="fa fa-chevron-right"></i></span>${profile.updatePasswordLinkTitle}</a>
                        </li>
                        */-->
                        <li>
                            <a href="javascript: void(0);" ng-click="nextStep('communications')" title="${profile.linkTitleCommunications}"> <span class="sso-badge"><i class="fa fa-chevron-right"></i></span>${profile.linkTitleCommunications}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                    <div class="sso-cta-link-spacer-align">
                        <a href="javascript:void(0)" ng-click="logOutProfile()" title="${profile.logoutLinkTitle}" class="sso-cta-link">${profile.logoutLinkTitle}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Profile Details form-->
    <div class="container" ng-switch-when="profileDetails">
        <div class="row" ng-controller="ProfileDetailsController">
            <div class="sso-preloader" ng-show="preloader"></div>
            <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                <h1 class="sso-h1">${profile.personalDetailsSectionTitle}</h1>
                <valid-form submitbtntext="${profile.profileDetailsUpdateButtonText}"
                            inputs="${profile.directiveProfile}"
                            blocking-validation-check="isDisabled"
                            after-render="afterRender()"
                            vm="thisForm"
                            requiredfieldstext="${profile.directiveProfileHasRequiredFields ? profile.requiredFieldsText : ''}"
                            submit-fn="submitFn(session, ref)" form-name="formName" session="session.data" ref="ref"
                            error-msg="errorMsg">
                </valid-form>
                <div class="sso-cta-link-spacer-align">
                    <a ng-click="nextStep('profileMenu')" href="javascript:void(0);" class="sso-cta-link back"><i class="fa fa-chevron-left"></i> {{backLinkText}}</a>
                </div>
            </div>
        </div>
    </div>


    <!-- Settings form-->
    <div ng-switch-when="settings">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                    <h1 class="sso-h1">${profile.settingsSectionTitle}</h1>
                </div>
                <!--/* the div below needs to be displayed only when a user needs to verify their account */-->
                <div ng-if="emailUpdatedNeedsVerification" class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4 text-center sso-paragragh">
                    <div class="sso-icon-large"><i class="fa fa-exclamation-circle fa-4x"></i></div>
                    <p class="sso-p" data-sly-test="${profile.accountVerificationMessage}">${profile.accountVerificationMessage @ context='html'}</p>
                    <button href="javascript: void(0);" title="${profile.sendVerificationEmailButtonText}" class="sso-btn-red resendVerificationButton" aria-haspopup="true" aria-disabled="false">${profile.sendVerificationEmailButtonText}</button>
                    <div class="sso-spacer-wrapper"></div>
                </div>
            </div>
        </div>
        <div class="container-fluid sso-full-width">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
                    <ul class="sso-list">
                        <li>
                            <a href="javascript: void(0);" ng-click="nextStep('updatepassword')" title="${profile.updatePasswordLinkTitle}"> <span class="sso-badge"><i class="fa fa-chevron-right"></i></span> ${profile.updatePasswordLinkTitle} </a>
                        </li>
                        <li data-sly-test="${profile.deleteAccountEnabled}">
                            <a href="javascript: void(0);" ng-click="nextStep('deleteaccount')" title="${profile.deleteAccountLinkTitle}"> <span class="sso-badge"><i class="fa fa-chevron-right"></i></span> ${profile.deleteAccountLinkTitle} </a>
                        </li>
                    </ul>
                    <div class="sso-cta-link-spacer-align">
                        <a ng-click="nextStep('profileMenu')" href="javascript:void(0);" class="sso-cta-link back"><i class="fa fa-chevron-left"></i> {{backLinkText}}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Password Form-->
    <div class="container" ng-controller="UpdatePasswordController" ng-switch-when="updatepassword"
        redirect-after-update-password="${profile.redirectAfterUpdatePasswordHref}">
        <div class="sso-preloader" ng-show="preloader"></div>
        <div class="row">
            <div class="col-xs-12  col-sm-6 col-sm-offset-3">
                <h1 class="sso-h1">${profile.updatePasswordFormTitle}</h1>
                <valid-form submitbtntext="${profile.updatePasswordSubmitButtonText}"
                            inputs="${profile.directiveUpdatePassword}"
                            requiredfieldstext="${profile.directiveUpdatePasswordHasRequiredFields ? profile.requiredFieldsText : ''}"
                            error-msg="errorMsg"
                            submit-fn="submitFn(session, ref)" form-name="formName" session="session" ref="ref">
                </valid-form>
                <div class="sso-cta-link-spacer-align">
                    <a ng-click="nextStep('settings')" href="javascript:void(0);" class="sso-cta-link back"><i class="fa fa-chevron-left"></i> {{backLinkText}}</a>
                </div>
            </div>
        </div>
    </div>


    <!-- Delete Account Form-->
    <div class="container" ng-switch-when="deleteaccount" data-sly-test="${profile.deleteAccountEnabled}">
        <div class="row" ng-controller="DeleteAccountController"
            delete-data-checked="${profile.deleteAccountData.included && profile.deleteAccountData.checkedByDefault ? 'true' : 'false'}"
            success-redirect="${profile.redirectAfterDeleteHref}">
            <div class="sso-preloader" ng-show="preloader"></div>
            <div class="col-xs-12 col-sm-6 col-sm-offset-3 text-center">
                <h1 class="sso-h1">${profile.deleteAccountFormTitle}</h1>
                <p class="sso-p">
                    <strong data-sly-test="${profile.deleteAccountSubtitle}">${profile.deleteAccountSubtitle}</strong><br />
                    ${profile.deleteAccountMessage}
                </p>
                <div class="sso-spacer-wrapper"></div>
                <div class="sso-input-error" ng-show="hasError">{{errorMsg}}</div>
                <div data-sly-test="${profile.deleteAccountData.included}" class="sso-fac sso-fac-checkbox sso-fac-default text-left">
                    <!--
                    ${profile.deleteAccountData.requiredError}
                    -->
                    <span>
                        <div tabindex="0" class="sso-checkbox-box-checked" role="checkbox" aria-checked="false" aria-label="${profile.deleteAccountData.label}">
                            <i class="fa fa-check"></i>
                        </div>
                    </span>

                    <input
                        name="deleteAccountData"
                        id="deleteAccountData"
                        type="checkbox"
                        value="true"
                        class="sso-checkbox"
                        data-isrequired="${profile.deleteAccountData.required}"
                        aria-label="${profile.deleteAccountData.label}"
                        data-sly-attribute.checked="${profile.deleteAccountData.checkedByDefault ? 'checked' : ''}"
                    />

                    <label for="deleteAccountData"
                        ng-click="toggleDeleteAccountData()">
                        <div class="sso-checkbox-box"></div>
                        ${profile.deleteAccountData.label}
                    </label>

                    <span class="asterisk sso-required" data-sly-test="${profile.deleteAccountData.required}"></span>
                </div>

                <a id="doDelete" href="javascript: void(0);" title="${profile.deleteAccountButtonText}" class="sso-btn-red"
                    ng-disabled="${(profile.deleteAccountData.included && profile.deleteAccountData.required) ? 'true' : 'false'} && !deleteAccountData"
                    ng-click="deleteAccount()">
                    ${profile.deleteAccountButtonText}
                </a>
                <div class="sso-cta-link-spacer-align">
                    <a ng-click="nextStep('settings')" href="javascript:void(0);" class="sso-cta-link back"><i class="fa fa-chevron-left"></i> {{backLinkText}}</a>
                </div>
                <div class="sso-cta-link-spacer-align">
                    <a href="javascript: void(0);" ng-click="cancel()" title="${profile.cancelLinkTitle}" class="sso-cta-link">${profile.cancelLinkTitle}</a>
                </div>
            </div>
        </div>
    </div>


    <!-- Communications form-->
    <div ng-switch-when="communications">
        <form name="communication-preferences" ng-controller="CommunicationPreferencesController">
            <div class="sso-preloader" ng-show="preloader"></div>
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                        <h1 class="sso-h1">${profile.communicationSectionTitle}</h1>
                    </div>
                </div>
            </div>
            <div class="container-fluid sso-full-width">
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
                        <div class="sso-input-error" ng-show="errorMsg.is">{{errorMsg.msg}}</div>
                        <ul class="sso-list">
                            <li data-sly-test="${profile.emailPromotionsIncluded}">
                                <label class="sso-ios">
                                    ${profile.emailPromotions.label}
                                    <input data-ios-checkbox="true" class="sso-checkbox" type="checkbox" role="checkbox"
                                        ng-true-value="'Y'"
                                        ng-false-value="'N'"
                                        ng-disabled="isDisabled"
                                        ng-model="session.data.emailPromotions"
                                        aria-checked="false"
                                        onkeydown="toggleCheckbox(event)" onclick="toggleCheckbox(event)" onfocus="focusCheckbox(event)" onblur="blurCheckbox(event)"/>
                                    <i tabindex="0" aria-label="${profile.emailPromotions.label}" role="checkbox" class="sso-ios-checkbox-toggle"></i>
                                </label>
                            </li>
                            <li class="sso-li-text" data-sly-test="${profile.emailPromotionsIncluded && profile.emailPromotions.description}">
                                ${profile.emailPromotions.description @ context='html'}
                            </li>
                            <li data-sly-test="${profile.sendSMSIncluded}">
                                <label class="sso-ios">
                                    ${profile.sendSMS.label}
                                    <input data-ios-checkbox="true" class="sso-checkbox" type="checkbox" role="checkbox"
                                        ng-true-value="'Y'"
                                        ng-false-value="'N'"
                                        ng-disabled="isDisabled"
                                        ng-model="session.data.sendSMS"
                                        name="sendSMS"
                                        aria-checked="false"
                                        onkeydown="toggleCheckbox(event)" onclick="toggleCheckbox(event)" onfocus="focusCheckbox(event)" onblur="blurCheckbox(event)"/>
                                    <i tabindex="0" aria-label="${profile.sendSMS.label}" role="checkbox" class="sso-ios-checkbox-toggle"></i>
                                </label>
                            </li>
                            <li class="sso-li-text" data-sly-test="${profile.sendSMSIncluded && profile.sendSMS.description}">
                                ${profile.sendSMS.description @ context='html'}
                            </li>
                            <li data-sly-test="${profile.pushNotificationsIncluded}">
                                <label class="sso-ios">
                                    ${profile.pushNotifications.label}
                                    <input data-ios-checkbox="true" class="sso-checkbox" type="checkbox" role="checkbox"
                                        ng-true-value="'Y'"
                                        ng-false-value="'N'"
                                        ng-disabled="isDisabled"
                                        ng-model="session.data.pushNotifications"
                                        aria-checked="false"
                                        onkeydown="toggleCheckbox(event)" onclick="toggleCheckbox(event)" onfocus="focusCheckbox(event)" onblur="blurCheckbox(event)"/>
                                    <i tabindex="0" aria-label="${profile.pushNotifications.label}" role="checkbox" class="sso-ios-checkbox-toggle"></i>
                                </label>
                            </li>
                            <li class="sso-li-text" data-sly-test="${profile.pushNotificationsIncluded && profile.pushNotifications.description}">
                                ${profile.pushNotifications.description @ context='html'}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="sso-spacer-wrapper"></div>
            <div class="container sso-full-width">
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                        <a ng-disabled="isDisabled" href="javascript: void(0);" ng-click="submitForm()" title="${profile.communicationsFormSubmitButtonTitle}" class="sso-btn-red">${profile.communicationsFormSubmitButtonTitle}</a>
                        <div class="sso-cta-link-spacer-align">
                            <a ng-click="nextStep('profileMenu')" href="javascript:void(0);" class="sso-cta-link back"><i class="fa fa-chevron-left"></i> {{backLinkText}}</a>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

</div>